<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IdentAgent.me - Your Omega Hub (VR Genie)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Import Three.js and OrbitControls -->
    <script async src="https://unpkg.com/es-module-shims@1.6.3/dist/es-module-shims.js"></script>
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.150.1/examples/jsm/"
        }
    }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden; /* Prevent scrolling on 3D scene */
        }
        .gradient-bg {
             background: radial-gradient(circle at top left, rgba(220, 38, 38, 0.05), transparent 50%),
                         radial-gradient(circle at bottom right, rgba(234, 179, 8, 0.05), transparent 60%);
        }
        #vr-genie-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0; /* Behind nav */
        }
        nav {
            position: relative;
            z-index: 10; /* Nav on top */
        }
        main {
            position: relative;
            z-index: 5; /* Header text on top */
            margin-top: -64px; /* Pull header text over canvas */
        }
        /* Styles for 3D Labels */
        .pillar-label {
            color: #fff;
            font-family: 'Inter', sans-serif;
            font-weight: 600;
            font-size: 14px;
            padding: 8px 16px;
            background-color: rgba(220, 38, 38, 0.8); /* Red */
            border: 1px solid rgba(251, 191, 36, 0.8); /* Yellow */
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.5);
            cursor: pointer;
            transition: transform 0.2s, background-color 0.2s;
        }
        .pillar-label:hover {
            transform: scale(1.1);
            background-color: rgba(251, 191, 36, 0.8); /* Yellow */
            color: #111827;
        }
    </style>
</head>
<body class="bg-gray-900 text-white gradient-bg">

    <!-- 3D Canvas Container -->
    <div id="vr-genie-container"></div>

    <!-- Main Navigation -->
    <nav class="bg-gray-800/50 backdrop-blur-md border-b border-gray-700/50">
        <div class="container mx-auto px-6">
            <div class="relative flex items-center justify-between h-16">
                <div class="text-2xl font-bold">IdentAgent.me</div>
                <div class="flex items-center space-x-4">
                    <a href="#" class="text-red-500 font-semibold px-3 py-2 rounded-md text-sm">Dashboard</a>
                    <a href="edit_profile.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Edit Profile</a>
                    <a href="security_shield.html" class="text-yellow-400 hover:text-yellow-300 px-3 py-2 rounded-md text-sm font-medium flex items-center gap-1">
                        <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" /></svg>
                        Security
                    </a>
                    <a href="login.html" class="text-gray-300 hover:text-white px-3 py-2 rounded-md text-sm font-medium">Log Out</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Header -->
    <main class="container mx-auto px-6 pb-20">
        <header class="text-center pt-24 pb-12">
            <h1 class="text-5xl font-extrabold text-white tracking-tight drop-shadow-lg">Welcome to Your Omega Hub</h1>
            <p class="mt-4 text-xl text-gray-300 max-w-2xl mx-auto drop-shadow-md">Click, drag, and zoom to explore your digital universe.</p>
        </header>
    </main>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import { CSS2DRenderer, CSS2DObject } from 'three/addons/renderers/CSS2DRenderer.js';

        let scene, camera, renderer, labelRenderer, controls;
        const pillarObjects = [];
        const raycaster = new THREE.Raycaster();
        const pointer = new THREE.Vector2();

        // 1. Pillar Data (The 8 Pillars)
        const pillars = [
            { name: "Central Hub", href: "edit_profile.html", color: 0xff0000 },
            { name: "C-Tech", href: "c_tech_hub.html", color: 0xffa500 },
            { name: "Marketplace", href: "marketplace_hub.html", color: 0xffff00 },
            { name: "Community", href: "community_hub.html", color: 0x00ff00 },
            { name: "OmniCreations", href: "omnicreations_hub.html", color: 0x0000ff },
            { name: "Education", href: "education_hub.html", color: 0x4b0082 },
            { name: "Monetization", href: "rewards_hub.html", color: 0x9400d3 },
            { name: "Wellness", href: "wellness_hub.html", color: 0xffffff }
        ];

        // 2. Initialization
        function init() {
            const container = document.getElementById('vr-genie-container');

            // Scene
            scene = new THREE.Scene();
            
            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 5, 20); // Start zoomed out
            
            // WebGL Renderer (for the 3D objects)
            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            container.appendChild(renderer.domElement);

            // CSS2D Renderer (for the HTML labels)
            labelRenderer = new CSS2DRenderer();
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.domElement.style.position = 'absolute';
            labelRenderer.domElement.style.top = '0px';
            container.appendChild(labelRenderer.domElement);

            // Controls
            controls = new OrbitControls(camera, labelRenderer.domElement); // Use labelRenderer for controls
            controls.enableDamping = true;
            controls.minDistance = 5;
            controls.maxDistance = 50;

            // Lighting
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
            scene.add(ambientLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
            directionalLight.position.set(5, 10, 7.5);
            scene.add(directionalLight);

            // Create Pillars
            createPillars();

            // Event Listeners
            window.addEventListener('resize', onWindowResize);
            window.addEventListener('click', onClick);
        }

        // 3. Create Pillars (Digital Stonehenge)
        function createPillars() {
            const radius = 10;
            const geometry = new THREE.CylinderGeometry(0.8, 1, 6, 32); // (radiusTop, radiusBottom, height, segments)
            
            pillars.forEach((pillar, i) => {
                const angle = (i / pillars.length) * Math.PI * 2;
                const x = Math.cos(angle) * radius;
                const z = Math.sin(angle) * radius;

                // Create the 3D mesh (the pillar)
                const material = new THREE.MeshStandardMaterial({ 
                    color: pillar.color,
                    emissive: pillar.color, // Make it glow
                    emissiveIntensity: 0.3
                });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.set(x, 3, z); // Y=3 because height is 6 (so 6/2)
                mesh.userData = { href: pillar.href }; // Store the link
                scene.add(mesh);
                pillarObjects.push(mesh);

                // Create the HTML label
                const labelDiv = document.createElement('div');
                labelDiv.className = 'pillar-label';
                labelDiv.textContent = pillar.name;
                labelDiv.addEventListener('click', () => {
                    window.location.href = pillar.href;
                });

                const label = new CSS2DObject(labelDiv);
                label.position.set(x, 7.5, z); // Position label above the pillar
                scene.add(label);
            });
        }

        // 4. Handle Window Resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            labelRenderer.setSize(window.innerWidth, window.innerHeight);
        }

        // 5. Handle Clicks (Raycasting)
        function onClick(event) {
            // We only need raycasting if the labels *aren't* clickable
            // Since the CSS2DObject labels are HTML elements, they capture clicks directly!
            // This simplifies things greatly.
            
            /* // Raycasting logic (if labels weren't used)
            pointer.x = (event.clientX / window.innerWidth) * 2 - 1;
            pointer.y = -(event.clientY / window.innerHeight) * 2 + 1;

            raycaster.setFromCamera(pointer, camera);
            const intersects = raycaster.intersectObjects(pillarObjects);

            if (intersects.length > 0) {
                const href = intersects[0].object.userData.href;
                if (href) {
                    window.location.href = href;
                }
            }
            */
        }

        // 6. Animation Loop
        function animate() {
            requestAnimationFrame(animate);
            controls.update(); // Update controls
            renderer.render(scene, camera);
            labelRenderer.render(scene, camera);
        }

        // --- Run ---
        init();
        animate();

    </script>
</body>
</html>
